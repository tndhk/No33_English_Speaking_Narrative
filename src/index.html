<!doctype html>
<html lang="ja">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>kaku</title>
    <link rel="stylesheet" href="./style.css" />
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&family=Outfit:wght@400;700&display=swap"
      rel="stylesheet"
    />
  </head>

  <body>
    <div id="app">
      <header>
        <h1>kaku</h1>
        <p class="subtitle" id="daily-subtitle"></p>
      </header>

      <!-- Landing Page (Authentication Required) -->
      <div id="auth-required" style="display: none">
        <div class="lp-container">
          <section class="lp-hero">
            <h2 class="lp-headline">日記を書こう。<br />日本語で、2行だけ。</h2>
            <p class="lp-description">
              あとはAIが、あなたの英語日記に仕上げます。<br />
              簡単だから、毎日続く。
            </p>
            <div id="login-container" class="lp-cta-container"></div>
          </section>

          <section class="lp-features">
            <div class="lp-feature-card">
              <div class="lp-feature-icon">✍️</div>
              <h3>日本語でOK</h3>
              <p>
                文法なんて気にしない。今日あったことを、いつもの言葉で書くだけ。
              </p>
            </div>
            <div class="lp-feature-card">
              <div class="lp-feature-icon">🤖</div>
              <h3>ネイティブ表現に</h3>
              <p>
                あなたの言葉を、自然で洗練された英語に変換。「こう言えばよかったのか」という発見があります。
              </p>
            </div>
            <div class="lp-feature-card">
              <div class="lp-feature-icon">🧠</div>
              <h3>忘れずに定着</h3>
              <p>
                忘却曲線に基づいたレビュー機能で、過去の日記を読み直せる。
                <br />学んだフレーズを確実にあなたのものにします。
              </p>
            </div>
          </section>

          <footer class="lp-footer">
            <p>© 2025 kaku. All rights reserved.</p>
            <p class="lp-privacy">Your entries are private and secure.</p>
          </footer>
        </div>
      </div>

      <!-- Main App Content (shown when authenticated) -->
      <div id="app-content" style="display: none">
        <!-- Desktop Navigation Tabs (Hidden on Mobile) -->
        <nav id="desktop-nav" class="nav-tabs">
          <button
            class="nav-tab active"
            data-view="generate"
            onclick="window.switchView('generate')"
          >
            <span style="font-size: 1.2rem">✍️</span> 書く
          </button>
          <button
            class="nav-tab"
            data-view="review"
            onclick="window.switchView('review')"
          >
            <span style="font-size: 1.2rem">📖</span> 振り返り
            <span
              id="due-badge-desktop"
              class="badge"
              style="display: none"
            ></span>
          </button>
          <button
            class="nav-tab"
            data-view="history"
            onclick="window.switchView('history')"
          >
            <span style="font-size: 1.2rem">📅</span> カレンダー
          </button>
        </nav>

        <main id="main-container">
          <!-- Content will be injected by main.js -->
          <div id="wizard-container" class="card">
            <div id="step-content">
              <!-- Steps injected here -->
            </div>
            <div id="step-actions">
              <button id="next-btn" class="primary">Next</button>
              <button id="prev-btn" class="secondary" style="display: none">
                Back
              </button>
            </div>
          </div>

          <div id="result-container" class="card" style="display: none">
            <!-- Result displayed here -->
          </div>
        </main>

        <!-- Mobile Bottom Navigation (Fixed) -->
        <nav id="bottom-nav" class="bottom-nav">
          <button
            class="bottom-nav-item active"
            data-view="generate"
            onclick="window.switchView('generate')"
          >
            <div class="icon">✍️</div>
            <div class="label">書く</div>
          </button>
          <button
            class="bottom-nav-item"
            data-view="review"
            onclick="window.switchView('review')"
          >
            <div class="icon-wrapper">
              <div class="icon">📖</div>
              <span
                id="due-badge-mobile"
                class="badge-dot"
                style="display: none"
              ></span>
            </div>
            <div class="label">振り返り</div>
          </button>
          <button
            class="bottom-nav-item"
            data-view="history"
            onclick="window.switchView('history')"
          >
            <div class="icon">📅</div>
            <div class="label">カレンダー</div>
          </button>
        </nav>

        <footer class="app-footer">
          <div id="logout-container"></div>
        </footer>

        <div id="loading-overlay" style="display: none">
          <div class="spinner"></div>
          <p id="loading-text">Writing your journal entry...</p>
        </div>
      </div>
      <!-- End app-content -->
    </div>
    <script type="module" src="./supabase.js"></script>
    <script type="module" src="./auth.js"></script>
    <script type="module" src="./storage.js"></script>
    <script type="module" src="./srs.js"></script>
    <script type="module" src="./review-session.js"></script>
    <script type="module" src="./export.js"></script>
    <script type="module" src="./stats.js"></script>
    <script type="module" src="./main.js"></script>
  </body>
</html>
