# My English Narrative AI — Phase 1 MVP要件定義書

## 1. プロダクト概要

### 1.1 プロダクト名

My English Narrative AI（仮称）

### 1.2 コンセプト

ユーザーの体験を素材に、暗記しやすい英語スクリプトと復習用テストを生成し、反復で定着させる。

### 1.3 ターゲットユーザー

* TOEIC 600〜900点程度
* 読める・聞けるが、会議等で言語化できない
* 汎用フレーズ学習に飽きている

---

## 2. MVPのスコープ（Phase 1）

### 2.1 MVPで提供する価値

* 日本語入力から、英語スクリプトと学習要素を一括生成
* 最小の復習運用（Notion / Sheets）に接続できるデータ形式
* 音声再生（端末内蔵TTS）で音読・シャドーイングを始められる

### 2.2 Phase 1でやらないこと

* 音声認識、発音採点、課金、ユーザー認証、アプリストア配布
* 履歴を使ったパーソナライズ最適化（モデル学習的なもの）
* 高度なSRS自動リマインド（手動運用）

---

## 3. 機能要件

## 3.1 Narrative Generator

### 3.1.1 ユーザーフロー

1. カテゴリ選択
2. 深掘り質問（2〜3問）
3. 出力設定確認（長さ・トーン）
4. 生成（JSONで受け取り、UI表示）
5. TTS再生、コピー、保存（Notion/Sheetsへ）

### 3.1.2 カテゴリ

* 今日の出来事
* 考え・気持ち
* おまかせ

### 3.1.3 深掘り質問

* 日本語で2〜3問
* 回答は自由入力テキスト
* 追加の1行入力（任意）を用意する
  例：目的、相手、数字、結論、のうち足りないものを1行で補う

### 3.1.4 出力設定

* 長さ：短め（3〜4文）／普通（5〜8文）／長め（10文以上）
* トーン：カジュアル／ビジネス／フォーマル
* Phase 1のデフォルトは「普通・ビジネス」

---

## 3.2 生成アウトプット仕様（固定JSON）

### 3.2.1 JSONスキーマ（必須）

* narrative_en: string
  英文。文数は設定に従う。改行は許容。
* key_phrases: array（最大5件）

  * phrase_en: string
  * meaning_ja: string
  * usage_hint_ja: string（短文）
* alternatives: array（最大2件）

  * original_en: string（本文からの該当表現）
  * alternative_en: string（言い換え）
  * nuance_ja: string（違いの説明を短く）
* recall_test: object（必須）

  * prompt_ja: string（要点3点程度の日本語）
  * expected_points_en: array（2〜4点、箇条書き想定。逐語回答ではなく要点）
* pronunciation: object（任意、該当時のみ）

  * word: string
  * ipa: string
  * tip_ja: string（アクセント等）

### 3.2.2 出力制約

* 普通：narrative_en は5〜8文を基本（±1文までは許容）
* key_phrases は最大5、alternatives は最大2、recall_test は必ず1問
* 日本語混入は最小化（英語本文に日本語を混ぜない）

---

## 3.3 品質・失敗判定（自動）

### 3.3.1 自動失敗判定条件（いずれかで失敗）

* JSONとしてパース不能
* 必須キー欠落（narrative_en / key_phrases / alternatives / recall_test）
* narrative_en が設定文数から大きく外れる（例：普通で3文以下、10文以上）
* 英語本文に日本語が多量に混入
* key_phrases が0件、alternatives が0件（いずれも最低1件は必要）

### 3.3.2 失敗時の挙動

* フォールバック1：DeepSeek（同一入力で再生成）
* それでも失敗：フォールバック2：xAI grok-4-fast
* それでも失敗：エラー表示（手動再試行ボタン、入力保持）

---

## 3.4 モデル・ルーティング要件（確定）

### 3.4.1 通常ルート

* Gemini 2.5 Flash-Liteで生成（1回で全要素を出す）

### 3.4.2 補助ルート（OpenAI gpt-5-nanoの担当範囲）

* 入力のマスク提案（機密・固有名詞の置換案の提示）
* 出力検証と軽い修復案の生成（JSON修復の提案）
  注意：nanoを使っても「追加の生成呼び出し」を増やしすぎない。基本は失敗時のみ。

### 3.4.3 フォールバック順

* DeepSeek → grok-4-fast

---

## 3.5 TTS（ブラウザ内蔵）

### 3.5.1 使用技術

* Web Speech API（speechSynthesis）

### 3.5.2 UI要件

* Voice選択（en-US / en-GB など端末内ボイス一覧から選択）
* 再生速度プリセット（例：0.9 / 1.0 / 1.1）
* 1文ずつ再生できる（全体再生とは別に、文単位の再生ボタン）
* クリップボードコピー

---

## 3.6 簡易SRS（Phase 1運用）

### 3.6.1 管理

* NotionまたはGoogle Sheets
* 保存する最小項目

  * date
  * category
  * narrative_en
  * recall_test.prompt_ja
  * next_review_date
  * review_result（完了/未完了、自己評価など）

### 3.6.2 復習間隔（固定）

* Day 0 / 1 / 3 / 7 / 14 / 30

---

## 4. 非機能要件

## 4.1 コスト前提（目安）

* 1回の生成で入力1500 tokens、出力600 tokens程度を上限の目安に設計
* 呼び出し回数を増やさない（原則1回、失敗時のみ再生成）

## 4.2 セキュリティ・プライバシー

* 仕事の機密が入りうる前提で、入力の注意書きを表示
* 可能なら「固有名詞を伏せる」ガイドをUIで提示
* ログ保存は最小（Phase 1は個人利用想定、保存先はユーザー側Notion/Sheets中心）

## 4.3 可用性

* 1社の障害で止まらないよう、フォールバックを必須要件とする
